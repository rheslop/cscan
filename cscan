#!/usr/bin/python

import argparse
import datetime
import os
import shutil
import subprocess
import sys

installpath=('.')
scanpath=('.')

cparser = argparse.ArgumentParser(prog='cscan')
cparser.add_argument('--import', help='Import tests')


def runScan():
    timestamp = datetime.datetime.now()
    print ("")
    print (timestamp)
    print ("------------")
    print ("Running Scan")
    print ("------------")
    print ("")

    for filename in os.listdir('%s' % (scanpath)):
        if filename != 'cscan':
            CHECK = (('%s/%s') % (scanpath, filename))
            # buffer is for alignment of results
            buffer = ('.' * (35 - len(CHECK)))

            try:
                subprocess.check_output(CHECK, stdin=None, stderr=subprocess.STDOUT, shell=False)
                print ("%s %s [ \033[0;32mPass\033[0m ]" % (filename, buffer))
            except subprocess.CalledProcessError as err:
                print ("%s %s [ \033[0;31mFail\033[0m ]" % (filename, buffer))
                rc = (err.returncode)
                output = (err.output)
                print ("Return code is %s and output is: %s" % (rc, output))

runScan()


# Possible options
# --scanpath -s
# --runtest -r
# --help -h

